/**
 * @fileoverview 核心输出规则 v2.0
 * @version 2.0.0
 * @lastUpdated 2025-12-01
 *
 * 【职责】
 * - JSON输出格式规范
 * - 响应格式要求
 * - 数据结构严格性规则
 * - AI感知游戏状态的核心约束
 *
 * 【设计原则】
 * - 最高优先级规则
 * - 技术性约束
 * - 确保系统正常运行
 * - 保证数据与叙事同步
 */

export const JSON_OUTPUT_RULES = `
# <输出格式强调>（最高优先级）

完整输出格式，包含所有字段和标签：
"""
<thinking>...</thinking>
\`\`\`json
{
  "text": "叙事文本(1500-2500字)",
  "mid_term_memory": "50-100字text事件摘要",
  "tavern_commands": [
    {"action":"set","key":"游戏时间.小时","value": 数字},
    {"action":"set","key":"人物关系.角色名.当前外貌状态","value":"描述"},
    {"action":"set","key":"人物关系.角色名.当前内心想法","value":"想法"},
    {"action":"push","key":"人物关系.角色名.记忆","value":"本次事件摘要"}
  ],
  "action_options": ["选项1", "选项2", "选项3", "选项4", "选项5"]
}
\`\`\`
"""

注意：
- 输出 JSON 前必须先输出 \`<thinking>CoT文本</thinking>\` 思维链
- 正文内容输出在 JSON 代码块（不要再输出其它标签：narrative/memory/commands/options）
- JSON 必须严格合法（双引号、无注释、无尾逗号），不要用中文引号/中文逗号
- \`action_options\` 为可选字段：
  - 若“行动选项”设置开启：必须输出 \`action_options\`（3-5个）
  - 若“行动选项”设置关闭：不要输出 \`action_options\` 字段

时间推进：
- 时间推进时更新：\`游戏时间.小时\`（或分钟，但必须推进）

变量更新（写了什么就必须同步什么）：
- 人物关系：\`人物关系.角色名.当前外貌状态\` / \`当前内心想法\`，并 \`push\` 记忆
- 各种进度、熟练度，物品的增删改，人物数据的更新，大道，用户状态，地图势力/点位，任务等所有存档状态

主路径检查清单（按需更新）：
▶ 角色基础信息
▶ 玩家角色状态
▶ 背包
▶ 装备栏
▶ 人物关系
▶ 世界信息
▶ 三千大道
▶ 任务系统
▶ 修炼功法
▶ 掌握技能
`.trim()

export const RESPONSE_FORMAT_RULES = `
# 数据同步铁律
**text写了什么，tavern_commands就必须更新什么！**

## 同步检查表
| 描写内容 | 必须更新 |
|---------|---------|
| 场景变化 | set 玩家角色状态.位置 {描述,x,y} |
| 时间流逝 | add 游戏时间.分钟 |
| NPC出场 | set 当前外貌状态/当前内心想法 |
| NPC互动 | push 记忆 + add 好感度 |
| 战斗受伤 | add 气血.当前(负) + push 状态效果 |
| 使用技能 | add 灵气.当前(负) |
| 修炼进度 | add 境界.当前进度 |
| 物品变化 | set/delete 背包.物品 |
| 灵石变化 | add 背包.灵石.品级 |
`.trim()

export const DATA_STRUCTURE_STRICTNESS = `
# 数据结构规则

## 只读字段（禁止修改）
装备栏、修炼功法、掌握技能、记忆、系统、角色基础信息、年龄

## 境界更新
- 小突破: add 当前进度
- 大突破: set 整个境界对象

## NPC创建
必须一次性创建完整对象，禁止分步添加字段
`.trim()
