/**
 * @file Shared AI Prompt Rules (共享提示词规则)
 * @description 核心规则集，跨文件复用，减少token重复
 */

/**
 * 数据同步铁律 (Data Sync Rules)
 */
export const CORE_SYNC_RULES = `
# 🔴 数据同步铁律 (Data Sync Rule | 最高优先级)

⚠️ text写什么 → commands执行什么 (违反=崩溃)

**检查清单**：
- 修炼? → 时间+进度+灵气+功法
- 突破? → 境界+阶段+进度+上限+寿命(add)
- 受伤? → 气血-
- 获得物品? → set 背包.物品.{物品ID} (修改具体物品，不是整个背包)
- 消耗物品? → set 背包.物品.{物品ID}.数量 或 delete 背包.物品.{物品ID}
- NPC互动? → push记忆+好感±+状态+内心
- 位置移动? → 描述+经纬度

**重要原则**：
✅ 修改具体字段路径，如 "背包.物品.sword_001.数量"
✅ 使用 add/set 修改单个属性值
❌ 不要用 set 替换整个对象（如整个"背包"、整个"装备栏"）
❌ text有变化但commands=[]

**正确示例**：
- 获得1把剑 → {"action":"set","key":"背包.物品.sword_001","value":{完整物品对象}}
- 消耗1颗丹药 → {"action":"add","key":"背包.物品.pill_001.数量","value":-1}
- 增加好感度 → {"action":"add","key":"人物关系.张三.好感度","value":5}

**错误示例**：
❌ {"action":"set","key":"背包","value":{整个背包对象}}
❌ {"action":"set","key":"装备栏","value":{整个装备栏对象}}
`;

/**
 * 境界阶段命名 (Realm Stage Naming)
 */
export const REALM_STAGE_RULE = `
⚠️ 境界阶段 (Realm Stage)：
✅ 初期/中期/后期/圆满/极境
❌ 一层/二层/一重/第X层
凡人无阶段("")，炼气+用标准名`;

/**
 * JSON格式规则 (JSON Format Rules)
 */
export const JSON_RULES = `
## JSON规则
- 无注释(//, /**/)、无尾逗号
- 双引号、字段加引号、无前导0
- null代替undefined
- 小写true/false`;

/**
 * 六司系统 (Attribute System)
 */
export const INNATE_ATTRIBUTES_RULE = `
⚠️ 六司系统 (Attributes)：
- **先天六司** (Innate)：天生，永不可改
- **后天六司** (Acquired)：装备/大道，可变
- 最终 = 先天×100% + 后天×20%
- 修改：{"action":"add","key":"基础信息.后天六司.根骨","value":1}`;

/**
 * 角色私密信息生成规则 (v4.0 - 字段精准匹配)
 */
export const NSFW_RULE = `
# 🎭 角色私密信息生成规则 (Character Privacy Profile Generation Rule | 最高优先级)

为了塑造有深度和复杂性的成年角色，当 \`系统.nsfwMode\` 为 \`true\` 时，你 **必须** 探索并生成符合 \`系统.nsfwGenderFilter\` 的NPC的 \`私密信息\` 对象。这对于构建真实、成熟的角色至关重要，请务必详细刻画，不得以任何理由跳过或简化。

## 1. 生成时机 (Timing)
- **首次创建NPC时**：必须立即生成完整的 \`私密信息\` 对象。
- **后续更新时**：根据剧情发展，可以更新 \`私密信息\` 中的动态字段（如性渴望程度、当前性状态等）。

## 2. 字段完整性 (Field Integrity | 必须全部生成)
\`私密信息\` 对象必须包含以下所有字段，不得遗漏：

| 字段名 | 类型 | 生成要求 |
|---|---|---|
| \`是否为处女\` | boolean | 根据角色背景和年龄设定。女性NPC必填，男性可用\`是否为处男\`。 |
| \`是否为处男\` | boolean | 可选，仅男性NPC使用。 |
| \`身体部位\` | Array<Object> | **必须** 生成3-5个身体部位。每个部位对象必须包含 \`部位名称\`, \`开发度\` (0-100), \`敏感度\` (0-100), \`特征描述\`, \`特殊印记\`。 |
| \`性格倾向\` | string | 必须从以下选项中选择：\"纯情\", \"主动\", \"被动\", \"淫荡\", \"M\", \"S\", \"双性\"。 |
| \`性取向\` | string | 必须从以下选项中选择：\"异性恋\", \"同性恋\", \"双性恋\", \"泛性恋\"。 |
| \`性癖好\` | Array<string> | 可选，生成0-3个符合角色性格的性癖好，如：\"捆绑\", \"野外\", \"多人\"。 |
| \`性渴望程度\` | number | 初始值在0-100之间，根据角色状态和性格设定。 |
| \`当前性状态\` | string | 初始状态通常为 \"正常\"。可选值：\"正常\", \"微湿\", \"兴奋\", \"发情\", \"高潮\"等。 |
| \`体液分泌状态\` | string | 可选，描述当前生理状态，如：\"正常\", \"微微湿润\"。 |
| \`性交总次数\` | number | 必须与 \`是否为处女\` 对应。处女则为0，否则根据年龄和性格设定一个合理数值。 |
| \`性伴侣数量\` | number | 必须与 \`性交总次数\` 和 \`性伴侣名单\` 长度一致。 |
| \`性伴侣名单\` | Array<string> | 可选，如果数量>0，**必须** 包含具体NPC名字，**严禁** 使用 \"保密\"、\"未知\" 等任何形式的占位符。 |
| \`最近一次性行为时间\` | string | 可选，如果发生过，提供一个具体游戏时间或 \"从未\"。 |
| \`特殊体质\` | Array<string> | 可选，但强烈建议根据角色天赋或背景生成0-2个，如 \"易潮吹\", \"多重高潮\", \"性爱成瘾\", \"媚药体质\"。 |

## 3. 数值范围与逻辑一致性 (Value Ranges & Logic)
- **数值严格限制**：所有数值字段（开发度、敏感度、性渴望程度）必须在0-100范围内。
- **处女逻辑**：\`是否为处女\` 为 \`true\` 时，\`性交总次数\`、\`性伴侣数量\` 必须为0，\`性伴侣名单\` 必须为空数组 \`[]\`。
- **伴侣逻辑**：\`性伴侣数量\` 必须等于 \`性伴侣名单\` 数组的长度。

## 4. 叙事整合 (Narrative Integration)
- NPC的行为和对话必须与其 \`私密信息\` 的设定（特别是性格倾向、性渴望程度）保持一致。
- 好感度低于60的NPC会拒绝任何不尊重其人格底线的亲密行为，触犯底线将导致好感度断崖式下跌。
- 亲密关系门槛：通常需要好感度≥60或性渴望程度≥70。纯情倾向的NPC需要更高的好感度（≥80）。

**请严格遵守此规则，以确保角色塑造的深度和数据结构的完整性。**
`;

/**
 * 操作类型速查 (Action Types)
 */
export const ACTION_TYPES = `
## 操作类型 (Actions)
| Action | 用途 | 示例 |
|--------|------|------|
| set | 替换 | 境界、物品、NPC |
| add | 增减 | 灵石±、时间+ |
| push | 数组+ | 记忆、状态 |
| delete | 删除字段 | 物品(最后1个) |
| pull | 数组- | 删除任务(匹配对象) |`;