# 大道朝天项目架构重构计划

## 新架构核心方案

### 数据流架构
```
组件 → Pinia Store (内存) ↔ IndexedDB (持久化)
         ↓
     酒馆助手 (仅AI交互)
```

### 核心原则
- **Pinia内存**：所有运行时数据存储在Pinia Store中
- **DB持久化**：只在需要时保存到IndexedDB
- **移除酒馆助手存储**：酒馆助手只负责AI对话，不存储游戏状态

## 实施进度

### ✅ 已完成
1. 分析当前架构问题
2. 设计新的数据流架构
3. 重构 Pinia Store 结构
   - 实现 gameStateStore (核心状态管理)
   - 简化 characterStore (角色管理)
4. 移除酒馆助手数据存储依赖
5. 实现内存+DB的持久化策略
6. 优化组件数据访问方式
7. 测试和验证新架构
8. 性能优化和清理旧代码

## 主要改进

### 架构优化
- 统一的游戏状态管理（gameStateStore）
- 简化的数据持久化流程
- 清晰的组件数据访问模式

### 性能提升
- 减少数据同步开销
- 优化内存使用
- 提升界面响应速度

### 开发体验
- 简化的代码结构
- 统一的数据管理接口
- 更好的调试和维护性